<!-- sidebar -->
{{> sidebar}}
<style>
    .SC{
        height: 100%;
        position: relative;
    }

    #SCBackground{
        position: absolute;
        top: 0; left: 0;
        height: 100%;
        width: 100%;
        z-index: -1;
    }

    #SCSlogan{
        position: absolute;
        top: 0;left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        background-color: rgba(0,0,0,.3);
        /*opacity: 0.3;*/
    }

    #slogan{
        text-align: center;
        position: absolute;
        top: 50%;
        margin-top: -174px;
    }
</style>
<div class="main">
    <div id="SC" class="SC">
        <div id="SCBackground">
            <!--<img id="canvasImage" src='/public/images/valle.jpg' style="height: 100%">-->
            <canvas id="canvas"></canvas>
        </div>

        <div id="SCSlogan">
            <section id="slogan" class="column">
                <header>
                    <div>
                        <img class="seeker-logo" src='/public/images/logo.png' alt="SeekBetter.Me">
                    </div>
                    <div>
                        <div class="seeker-title">Seek Better . Me</div>
                        <div class="seeker-subtitle"> You have got to find what you love</div>
                    </div>
                </header>
            </section>
        </div>
    </div>

    <script>

    </script>
    <div style="background-color: #FFF">
    <!-- Articles -->
    {{#articles}}
    <div class="article">
        <div  class="row">
            <article class="column">
                <header>
                    <div class="title"><a href="/article/{{_id}}" title="{{title}}">{{title}}</a></div>
                    <div class="metadata">
                        <i class="typcn typcn-calender"><span>{{friendlyDate}}</span></i>
                        <i class="typcn typcn-tag">
                            {{#tags}}
                            <span>{{name}}</span>
                            {{/tags}}
                        </i>
                        <i class="typcn typcn-message"><a href="/article/{{_id}}#disqus_thread">木有评论</a></i>
                    </div>
                </header>
                <section class="section markdown">
                    {{{content}}}
                </section>
            </article>
        </div>
        <div class="row" style="text-align: center;font-style: italic">
           <a href="/article/{{_id}}">— more —</a>
        </div>
    </div>
    {{/articles}}

    <div class="row" style="margin-top: 30px">
        <div class="pagination-centered">
            <ul class="pagination">
                {{#pages}}
                <li {{#active}}class="current"{{/active}}><a href="/articles/page/{{page}}">{{page}}</a></li>
                {{/pages}}
            </ul>
        </div>
    </div>

    </div>
    <!--<div class="row" style="margin-top: 30px">-->
        <!--<div class="pagination-centered">-->
            <!--<ul class="pagination">-->
                <!--<li class="arrow unavailable"><a href="">&laquo;</a></li>-->
                <!--<li class="current"><a href="">1</a></li>-->
                <!--<li><a href="">2</a></li>-->
                <!--<li><a href="">3</a></li>-->
                <!--<li><a href="">4</a></li>-->
                <!--<li class="unavailable"><a href="">&hellip;</a></li>-->
                <!--<li><a href="">12</a></li>-->
                <!--<li><a href="">13</a></li>-->
                <!--<li class="arrow"><a href="">&raquo;</a></li>-->
            <!--</ul>-->
        <!--</div>-->
    <!--</div>-->

    <footer class="footer">
        <div class="row">
            <div class="column">
                <p>SeekBetter.Me&nbsp;&nbsp;&nbsp;&nbsp;Copyright©2014<br><b>iSeeker ®</b>  |  强力驱动</p>
                <img src="/public/images/footerlogo.png"/>
            </div>
        </div>
    </footer>
</div>

{{#yield-script}}
<script type="text/javascript">
    console.log("What");
    require(['main'],function(){
        require(['jquery','modules/blur/CanvasBlur'],function($,CanvasBlur){

            var scale_x = $("#SC").width();
            var scale_y = $("#SC").height();
            var cImg = new Image();
            var aaa = null;
            cImg.src = '/public/images/valle.jpg';
            cImg.onload =function(){
                CanvasBlur.CanvasBlur(document.getElementById('canvas'),this,1,scale_x,scale_y);
            };

            var SCBackground = document.getElementById('SCBackground');
            SCSlogan = document.getElementById('SCSlogan');
            var oTop_1 = 0,
                oTop_2 = 0;

            addEvent(window,'scroll',onScroll);
//            onScroll();
            var compare = {a:true,b:true};
            function onScroll(e){
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                SCBackground.style.top = oTop_1+scrollTop*.9+'px';
                SCSlogan.style.top = oTop_2+scrollTop*.7+'px';

                if(scrollTop < 100 && scrollTop > 0 && compare.a){
                    CanvasBlur.CanvasBlur(document.getElementById('canvas'),cImg,2,scale_x,scale_y);
                    compare.a = false;
                }

                if(scrollTop > 100 && compare.b){
                    CanvasBlur.CanvasBlur(document.getElementById('canvas'),cImg,4,scale_x,scale_y);
                    compare.b = false;
                    compare.a = true;
                }

                if(scrollTop == 0){
                    CanvasBlur.CanvasBlur(document.getElementById('canvas'),cImg,0,scale_x,scale_y);
                    compare.a = true;
                    compare.b = true;
                }
//                var blurParam = parseInt(scrollTop/100);
//                console.log(scrollTop);
////                console.log(blurParam);
//                if(blurParam != compare){
//                    CanvasBlur.CanvasBlur(document.getElementById('canvas'),cImg,blurParam,scale_x,scale_y);
//                    compare = blurParam;
//                    console.log("渲染一次");
//                }
            }

            function addEvent(eventTarget, eventType, eventHandler) {
                if (eventTarget.addEventListener) {
                    eventTarget.addEventListener(eventType, eventHandler, false);
                } else {
                    if (eventTarget.attachEvent) {
                        eventType = "on" + eventType;
                        eventTarget.attachEvent(eventType, eventHandler);
                    } else {
                        eventTarget["on" + eventType] = eventHandler;
                    }
                }
            }

        });
    });
</script>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'seekbetterme'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
{{/yield-script}}